try{const e=document.querySelector("html"),t="data-platform";if(navigator.userAgentData&&navigator.userAgentData.platform){const n=navigator.userAgentData.platform.toLowerCase();if(n.includes("linux")){e.setAttribute(t,"linux")}else if(n.includes("windows")){e.setAttribute(t,"windows")}else if(n.includes("mac")){e.setAttribute(t,"macos")}}else if(navigator.platform){const n=navigator.platform.toLowerCase();if(n.includes("linux")){e.setAttribute(t,"linux")}else if(n.includes("win")){e.setAttribute(t,"windows")}else if(n.includes("mac")){e.setAttribute(t,"macos")}}}catch(e){console.warn("Failed to detect platform:",e)}function theme_spinner(e,t,n){const r="cspinner_container";e=e?e:document.querySelector("button i.fa-sign-in:not(.invisible)")||document.querySelector("button i.fa-qrcode:not(.invisible)"),s='<span class="'+r+'"><span class="cspinner">'+'<span class="cspinner-icon white small"></span></span></span>';if(e&&!t){e.classList.add("invisible");e.insertAdjacentHTML("afterend",s);e.parentNode.classList.add("disabled");e.parentNode.disabled=true}else if(e&&t){e.classList.remove("invisible");e.parentNode.classList.remove("disabled");e.parentNode.disabled=false;const t=e.parentNode.querySelector("."+r);if(t){t.parentNode.removeChild(t)}if(n){e.className="fa2 fa2-marker-check";e.parentNode.classList.add("disabled")}}}function theme_content_loaded(){const e=typeof theme_language==="object"?theme_language:{},t=".container.session_login",n=".session_login_back.forgot",r=function(e,t){const n=(e?"faa-bounce animated":"faa-horizontal animated").split(" ");t.classList.add(...n);setTimeout(()=>{t.classList.remove(...n)},1500)};(function(){const e=document.querySelectorAll('input[type="password"]');e.forEach(e=>{const t=document.createElement("span");t.classList.add("input_warning_caps");t.setAttribute("title","Caps Lock");t.classList.add("large");e.classList.add("use_input_warning_caps");e.parentNode.insertBefore(t,e.nextSibling);e.addEventListener("blur",function(){this.nextSibling.classList.remove("visible")});e.addEventListener("keydown",function(e){if(typeof e.getModifierState==="function"){let t;if(e.keyCode===20){t=!e.getModifierState("CapsLock")}else{t=e.getModifierState("CapsLock")}if(t){this.nextSibling.classList.add("visible")}else{this.nextSibling.classList.remove("visible")}}})})})();(function(){const n=document.querySelector('[name="twofactor"]');if(n){const o=document.querySelector('[data-submit="2fa"]'),s=o.querySelector("i"),i=o.getAttribute("data-prefix"),c=location.origin+(i||""),a=document.querySelector('[name="user"]'),l=document.querySelector('[name="pass"]'),u=document.querySelector('[name="save"]'),f=n.closest("form"),d=f.getAttribute("action")||url.toString(),m=function(o){o.preventDefault();theme_spinner(s);const i=new URLSearchParams;i.append("user",a.value);i.append("pass",l.value);if(u){i.append("save",u.checked?1:0)}i.append("twofactor",n.value);fetch(d,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i}).then(t=>{if(t.url){p=t.url}if(!t.ok){throw new Error(e.session_neterror)}return t.text()}).then(e=>{const n=new DOMParser,o=n.parseFromString(e,"text/html");const i=o.querySelector(t);if(i){theme_spinner(s,true);const e=document.querySelector(t),n=e.querySelectorAll(".alert");n.forEach(e=>e.remove());const i=o.querySelector(".alert");if(i){e.insertBefore(i.cloneNode(true),e.firstChild);r(false,e.querySelector(".alert"))}return}location.href=p}).catch(e=>{location.href=p})};let p=c;if(n){n.addEventListener("keydown",function(e){if(e.key==="Enter"){e.preventDefault();if(o)o.click();return false}})}f.addEventListener("submit",function(r){r.preventDefault();const s=new URLSearchParams;s.append("user",a.value);s.append("pass",l.value);if(u){s.append("save",u.checked?1:0)}s.append("twofprobe",1);fetch(d,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s}).then(t=>{if(t.url){p=t.url}if(t.status===401){return{needsTwoFactor:true}}else if(!t.ok){throw new Error(e.session_neterror)}else{return t.text().then(e=>{return{needsTwoFactor:false,htmlResponse:e}})}}).then(e=>{if(e.needsTwoFactor){const e=document.querySelector(".session_login_flipper");e.classList.toggle("flipped");e.classList.toggle("twofactor");const t=document.querySelector(".alert");if(t){t.remove()}setTimeout(()=>{n.focus()},600);o.removeEventListener("click",m);o.addEventListener("click",m);return}else{const n=e.htmlResponse,r=new DOMParser,o=r.parseFromString(n,"text/html");const s=document.querySelector(t),i=o.querySelector(t);if(s&&i){s.innerHTML=i.innerHTML;theme_content_loaded();setTimeout(()=>{document.querySelector('[name="pass"]').focus()});return}location.href=p}}).catch(e=>{console.warn("Request failed:",e);location.href=p})})}})();(function(){const o=document.querySelector(n+" .form-signin-group > .btn-success"),s=document.querySelectorAll(".session_login_flipper [data-flipper]"),i=document.querySelector(n+' input[name="forgot"]'),c=document.querySelector(n+" [data-unlocker]"),a=document.querySelector(n+' input[name="newpass"]'),l=document.querySelector(n+' input[name="newpass2"]'),u=t,f=function(e){let t=e.querySelector(".panel-body > [data-fatal-error-text]");if(!t||!t.textContent.trim()){t=e.querySelector(".panel-body > .err-content")}return t},d=function(t,n){let o=document.querySelector(u+" > .alert");if(o){o.remove()}o=document.createElement("div");o.className="alert";o.innerHTML=`\n                    <strong><i class="fa"></i> </strong><br>\n                    <span></span>`;const s=document.querySelector(u);if(s){s.insertBefore(o,s.firstChild)}o.classList.remove("alert-warning","alert-success","alert-danger");const i=o.querySelector(".fa"),c=o.querySelector("strong"),a=o.querySelector("span");if(t==="success"){r(true,o);o.classList.add("alert-success");if(i)i.className="fa fa-check-circle";if(c)c.innerHTML='<i class="fa fa-check-circle"></i> '+e.session_success;if(a)a.innerHTML=n}else{r(false,o);o.classList.add("alert-danger");if(i)i.className="fa fa-exclamation-circle";if(c)c.innerHTML='<i class="fa fa-exclamation-circle"></i> '+e.session_error;if(a)a.textContent=n}};if(s){s.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(".session_login_flipper"),n=t.classList.contains("forgot");!n&&t.classList.toggle("flipping",true);!n&&t.classList.toggle("forgot",true);setTimeout(()=>{n&&t.classList.toggle("flipping",false);n&&t.classList.toggle("forgot",false)},600);t.classList.toggle("flipped");const r=document.querySelector('input[name="pass"]'),o=!t.classList.contains("flipped")?document.querySelector('input[name="user"]'):document.querySelector('input[name="forgot"]');if(o){setTimeout(()=>{if(t.classList.contains("flipped")||!o.value.trim()){o.focus()}else if(r){r.focus()}},600)}})})}if(i){i.addEventListener("keydown",function(e){if(e.key==="Enter"){e.preventDefault();if(o)o.click();return false}})}if(a){a.addEventListener("keydown",function(e){if(e.key==="Enter"){e.preventDefault();if(l)l.focus();return false}});if(l){l.addEventListener("keydown",function(e){if(e.key==="Enter"){e.preventDefault();if(c)c.click();return false}})}}if(o){o.addEventListener("click",function(t){t.preventDefault();if(this.classList.contains("disabled")){return}if(!i||!i.value.trim()){d("error",e.session_cannot);return}const n=i.value.trim(),r=this.querySelector("i"),o=function(e){if(!e){return null}const t=e.match(/Remote Error: (.*)/);if(t&&t.length>1){return t[1].trim()}return null};theme_spinner(r);fetch("forgot_send.cgi",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:`forgot=${encodeURIComponent(n)}`}).then(t=>{if(t.url){serverRedirectUrl=t.url}if(!t.ok){throw new Error(e.session_neterror)}return t.text()}).then(t=>{const n=new DOMParser,s=n.parseFromString(t,"text/html");const c=s.querySelector(".panel-body > center");if(c&&c.textContent.trim()){theme_spinner(r,true,true);d("success",c.innerHTML.trim());return}theme_spinner(r,true);const a=f(s);if(a&&a.textContent.trim()){d("error",a.textContent.trim());i.focus();return}d("error",o(t)||e.session_unkerror)}).catch(t=>{theme_spinner(r,true);console.warn("Request failed:",t);d("error",o(t)||e.session_conerror)})})}if(c){const t=document.querySelector(n),r=function(){t.remove();const e=new URL(window.location.href);e.search="";history.replaceState({},document.title,e);const n=document.querySelector(u+" .alert");if(n){n.remove()}location.reload()};if(s.length>1){s[1].addEventListener("click",function(e){e.preventDefault();r()})}if(a){setTimeout(()=>{a.focus()},0)}c.addEventListener("click",function(n){n.preventDefault();if(this.classList.contains("disabled")){return}if(!a||!a.value.length){d("error",e.session_resetepassreq);return}if(!l||!l.value.length){d("error",e.session_pwdconf);return}const r=a.value;const o=l.value;if(r!==o){d("error",e.session_pwdmatch);return}const i=t?t.getAttribute("data-forgot"):null,c=t?t.getAttribute("data-username"):null;if(!i){d("error",e.session_noid);return}const u=this.querySelector("i");theme_spinner(u);fetch("forgot.cgi",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:`id=${encodeURIComponent(i)}&newpass=${encodeURIComponent(r)}&newpass2=${encodeURIComponent(o)}`}).then(t=>{if(t.url){serverRedirectUrl=t.url}if(!t.ok){throw new Error(e.session_neterror)}return t.text()}).then(t=>{const n=new DOMParser,r=n.parseFromString(t,"text/html");const o=f(r);if(o&&o.textContent.trim()){theme_spinner(u,true);d("error",o.textContent.trim());return}theme_spinner(u,true,true);s[0].click();d("success",e.session_pwdsucc);const i=new URL(window.location.href);i.search="";history.replaceState({},document.title,i);s.forEach(e=>{e.remove()});if(c){document.querySelector('[name="user"]').value=c;const e=document.querySelector('[name="pass"]');if(e){e.focus()}}}).catch(t=>{theme_spinner(u,true);console.warn("Request failed:",t);d("error",e.session_conerror)})})}})();(function(){const e=document.querySelectorAll(t+" > .alert");if(e){e.forEach(e=>{setTimeout(()=>{e.classList.remove("animated")},1500)})}})()}document.addEventListener("DOMContentLoaded",theme_content_loaded);